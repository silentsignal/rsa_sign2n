import sys
import jwt

if len(sys.argv) < 3:
    print("Usage: %s <Tampered JWT> <Original public key file>" % (sys.argv[0]))
    exit()

public_key=open(sys.argv[2],"rb").read()
print(sys.argv[1])
try:
    jwt.decode(sys.argv[1], public_key)
    print("[+] VULNERABLE - JWT successfully validated with key: %s" % (sys.argv[2]))
    exit(0)
except jwt.exceptions.ExpiredSignatureError:
    print("[-] Expired! Please update `exp`! ")
    exit(1)
except jwt.exceptions.DecodeError:
    print("[-] Verification failed :(")
    exit(2)
